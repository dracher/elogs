title: AngularJS Notes 01
thumbnail: /img/blog.png
categories: Technical
date: 2015-12-28 15:27:54
tags: [angular, javascript]
---

# 1. Conceptual Overview

Concept  | Description
------------------------- | -------------
[x]  Template             | HTML with additional markup
[x]  Directives           | extend HTML with custom attributes and elements
[x]  Model                | the data shown to the user in the view and with which the user interacts
[ ]  Scope                | context where the model is stored so that controllers, directives and expressions can access it
[ ]  Expressions          | access variables and functions from the scope
[ ]  Compiler             | parses the template and instantiates directives and expressions
[ ]  Filter               | formats the value of an expression for display to the user
[ ]  View                 | what the user sees (the DOM)
[ ]  Data Binding         | sync data between the model and the view
[ ]  Controller           | the business logic behind views
[ ]  Dependency Injection | Creates and wires objects and functions
[ ]  Injector             | dependency injection container
[ ]  Module               | a container for the different parts of an app including controllers, services, filters, directives which configures the Injector
[ ]  Service              | reusable business logic independent of views

<!-- more -->

# 2. Services

Angular services are:

- **Lazily instantiated** – Angular only instantiates a service when an application component depends on it.
- **Singletons** – Each component dependent on a service gets a reference to the single instance generated by the service factory.

## Create Service

- Registering Services

```javascript
var myModule = angular.module('myModule', []);
myModule.factory('serviceId', function() {
  var shinyNewServiceInstance;
  // factory function body that constructs shinyNewServiceInstance
  return shinyNewServiceInstance;
});
```

- Registering a Service with `$provide`

```javascript
angular.module('myModule', []).config(['$provide', function($provide) {
  $provide.factory('serviceId', function() {
    var shinyNewServiceInstance;
    // factory function body that constructs shinyNewServiceInstance
    return shinyNewServiceInstance;
  });
}]);
````

# 3. Scope

## Two APIs

1. Scopes provide APIs (`$watch`) to observe model mutations.
2. Scopes provide APIs (`$apply`) to propagate any model changes through the system into the view from outside of the "Angular realm" (`controllers`, `services`, `Angular event handlers`).

Both `controllers` and `directives` have reference to the `scope`, but not to each other. This arrangement isolates the controller from the directive as well as from the DOM. **This is an important point since it makes the controllers view agnostic**, which greatly improves the testing story of the applications.

## Retrieving Scopes from the DOM

Scopes are attached to the DOM as $scope data property, and can be retrieved for debugging purposes. (It is unlikely that one would need to retrieve scopes in this way inside the application.) The location where the root scope is attached to the DOM is defined by the location of ng-app directive. Typically ng-app is placed on the `<html>` element, but it can be placed on other elements as well, if, for example, only a portion of the view needs to be controlled by Angular.

To examine the scope in the debugger:

1. Right click on the element of interest in your browser and select `inspect element`. You should see the browser debugger with the element you clicked on highlighted.
2. The debugger allows you to access the currently selected element in the console as `$0` variable.
3. To retrieve the *associated scope* in console execute: `angular.element($0).scope()` or just type `$scope`


## Scope Events Propagation

The event can be:

- `$broadcast` to the scope **children**
- `$emit` to scope **parents**

```javascript
angular.module('eventExample', [])
.controller('EventController', ['$scope', function($scope) {
  $scope.count = 0;
  $scope.$on('MyEvent', function() {
    $scope.count++;
  });
}]);
```

## Notes

- Notice that Angular automatically places `ng-scope` class on elements where scopes are attached. 



# 4. Directive

## restrict

String of subset of EACM which restricts the directive to a specific directive declaration style. If omitted, the defaults (elements and attributes) are used.

- E - Element name (default): <my-directive></my-directive>
- A - Attribute (default): <div my-directive="exp"></div>
- C - Class: <div class="my-directive: exp;"></div>
- M - Comment: <!-- directive: my-directive exp -->

## Isolating the Scope of a Directive

好别扭的用法啊！！！

- script.js

  ```javascript
  angular.module('docsIsolateScopeDirective', [])
  .controller('Controller', ['$scope', function($scope) {
    $scope.naomi = { name: 'Naomi', address: '1600 Amphitheatre' };
    $scope.igor = { name: 'Igor', address: '123 Somewhere' };
  }])
  .directive('myCustomer', function() {
    return {
      restrict: 'E',
      scope: {
        customerInfo: '=info'
      },
      templateUrl: 'my-customer-iso.html'
    };
  });
  ```

- index.html

  ```html
  <div ng-controller="Controller">
    <my-customer info="naomi"></my-customer>
    <hr>
    <my-customer info="igor"></my-customer>
  </div>
  ```

- my-customer-iso.html

  ```html
  Name: {{customerInfo.name}} Address: {{customerInfo.address}}
  ```
